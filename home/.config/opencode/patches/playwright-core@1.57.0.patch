# Fix playwright WebSocket compatibility issue in Bun
# https://github.com/oven-sh/bun/issues/9911
diff --git a/lib/utilsBundle.js b/lib/utilsBundle.js
index 7dd8831f29c19f2e20468508b77b0a3f9d204ae6..a3d4b28d6401f46828b5ebf25baa764c633ff5b2 100644
--- a/lib/utilsBundle.js
+++ b/lib/utilsBundle.js
@@ -59,7 +59,7 @@ const program = require("./utilsBundleImpl").program;
 const ProgramOption = require("./utilsBundleImpl").ProgramOption;
 const progress = require("./utilsBundleImpl").progress;
 const SocksProxyAgent = require("./utilsBundleImpl").SocksProxyAgent;
-const ws = require("./utilsBundleImpl").ws;
+const ws = 'Bun' in globalThis ? require('ws') : require("./utilsBundleImpl").ws;
 const wsServer = require("./utilsBundleImpl").wsServer;
 const wsReceiver = require("./utilsBundleImpl").wsReceiver;
 const wsSender = require("./utilsBundleImpl").wsSender;
